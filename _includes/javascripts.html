<script>
    $(document).ready(function() {
        var timer;

        $(window).bind('scroll', (function() {
            clearTimeout(timer);
            timer = setTimeout(getPercent, 5);
        }));

        // Simple search part1                
        $('.search-field').simpleJekyllSearch({
            jsonFile: '{{site.url}}/search.json',
            template: '<li><span class="leaders-left">{date}</span><a href="{url}" title="{title}" class="leaders-right">{title}</a></li>',
            searchResults: '.results',
            searchResultsTitle: '#',
            noResults: '<li>Tweaa, nothing found :( <strong><a href="/"> Return to home-page</a></strong></li>'
        });

        //remove search cookie after use
        if (String(window.location.href).search("search.html") !== -1) {
            $(".search-field").val($.cookie("searchcookie"));
            $.removeCookie("searchcookie");
        }
    });

    // Simple search part2
//    (function($, window, undefined) {
    var bs = {
        close: $(".icon-remove-sign"),
        searchfield: $(".search-field")
    };

    //Loads only after page fully loads
    $(window).bind("load", function() {
        toggleRemoveSign();
        $(".search-field").focus();
    });

    //remove all text from searchfield
    bs.close.on('click', function() {
        bs.searchfield.val('');
        toggleRemoveSign();
    });


    //Trigger when the searchfield is filled
    bs.searchfield.on('input', function() {
        toggleRemoveSign();
    });

    //Search ONLY after hitting enter
    bs.searchfield.on('keydown', function() {
        if (event.keyCode == 13) {
            event.preventDefault();
            openSearchPage();
        }
        ;
    });

    //open search page on- searchfield on-input
    function openSearchPage() {
        var url = String(window.location.href);
        if (url.search("search.html") == -1) {
            $.cookie("searchcookie", $(".search-field").val());
            if (bs.searchfield.val().length > 0) {
                window.open('{{site.url}}/search.html', '_self');
            }
        }
    }
//    })(jQuery, window);

    function getPercent() {
        t = $(window).scrollTop();
        p = (t / ($(document).height() - $(window).height())) * 100;
        $(".statusbar").css("width", String(p) + "%");

        if (p > 97) {
            $(".statusbar").css("background-color", "#1ca265");
        } else {
            $(".statusbar").css("background-color", "#eb5e29");
        }
        return;
    }

    //hide close icon if searchfield is empty
    function toggleRemoveSign() {
        if ($(".search-field").length) { //if searchbox exists then,
            if ($(".search-field").val().length > 0)
                $(".icon-remove-sign").css({display: "inline-block"});
            else
                $(".icon-remove-sign").css({display: "none"});
        }
    }

    //BS tooltip activate
    $("#brand-return").tooltip();

    //Analytics
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', '{{ site.ga_id }}', '{{ site.ga_username }}');
    ga('send', 'pageview');

    {% if page.comments %}
    //Disquss
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = '{{ site.owner.disqus_shortname }}'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    {% endif %}
</script>       
